---
title: "Homework 1"
author: "Baris Arslan"
date: "4/6/2022"
output: html_document
---

## Required Packages and Data
```{r}

library(readxl)
library(ggplot2)
library(zoo)
library(corrplot)

```

## 1) Introduction

In the Homework 1 of IE360: Statistical Forecasting and Time Series course, four different data sets are obtained with respect the to the area of interest.\
Data sets are as follows:

  + Debit Card and Credit Card Total Expenditure Amount on Car Rental over 2014-2022
  + Weighted Average Interest Rates For Banks Loans (Vehicle) over 2014-2022
  + Total Number of Tourist in Turkey over 2014-2022
  + Google Trends Search Results for the keyword "Araba kiralama" over 2014-2022 
  
First 3 data sets are obtained from Electronic Data Delivery System: https://evds2.tcmb.gov.tr/ \
Last data set is obtained form Google Trends: https://trends.google.com/trends/\
  

In this homework, the area of interest and research question is:\
**Is the total expenditure amount on car rental in Turkey correlated with the interest rates for vehicle loans and the total number of tourist in Turkey?**



## 2) Debit Card and Credit Card Total Expenditure Amount on Car Rental over 2014-2022

In this section, "Debit Card and Credit Card Total Expenditure Amount on Car Rental" data is analyzed.
Total expenditure amounts are reported monthly in Thousand TRY units.
Time range for the data is from March 2014 to January 2022.

# 2.1) Dataset
```{r}

ExpendCarRental <- read_excel("Data/Debit_Credit_Expenditure_Car_Rental.xlsx")
ExpendCarRental$Date <- as.yearmon(ExpendCarRental$Date)
head(ExpendCarRental)
tail(ExpendCarRental)
summary(ExpendCarRental$Amount)
str(ExpendCarRental)
```

# 2.2) Plot of the Data
```{r}
ggplot(ExpendCarRental, aes(Date, Amount)) +
  geom_line(data = ExpendCarRental, color="red", linetype = "solid") +
   ggtitle("Debit Card and Credit Card Total Expenditure Amount on Car Rental") +
    xlab("Date (Monthly)") + ylab("Total Expenditure (Thousand TRY)") +
    theme_linedraw()
```

# 2.3) Boxplot of the Data
```{r}

```



## 3) Weighted Average Interest Rates For Banks Loans (Vehicle) over 2014-2022

In this section, "Weighted Average Interest Rates For Banks Loans (Vehicle)" data is analyzed.
Weighted average interest rates are reported monthly in percentages(%).
Time range for the data is from March 2014 to January 2022.

# 3.1) Dataset
```{r}

InterestRateVehicles <- read_excel("Data/Interest_Rate_Vehicles.xlsx")
InterestRateVehicles$Date <- as.yearmon(InterestRateVehicles$Date)
head(InterestRateVehicles)
tail(InterestRateVehicles)
summary(InterestRateVehicles$Rates)
str(InterestRateVehicles)

```

# 3.2) Plot of the Data
```{r}

ggplot(InterestRateVehicles, aes(Date, Rates)) +
  geom_line(data = InterestRateVehicles, color="blue", linetype = "solid") +
   ggtitle("Interest Rates for Vehicles") +
    xlab("Date (Monthly)") + ylab("Interest Rates (%)") +
    theme_linedraw()

```

# 3.3) Boxplot of the Data
```{r}

```



## 4) Total Number of Tourist in Turkey over 2014-2022

In this section, "Total Number of Tourists in Turkey" data is analyzed.
Total number of tourists data is reported monthly.
Time range for the data is from March 2014 to January 2022.

# 4.1) Dataset
```{r}

TotalTourists <- read_excel("Data/Total_Tourists.xlsx")
TotalTourists$Date <- as.yearmon(TotalTourists$Date)
head(TotalTourists)
tail(TotalTourists)
summary(TotalTourists$Tourists)
str(TotalTourists)

```

# 4.2) Plot of the Data
```{r}

ggplot(TotalTourists, aes(Date, Tourists)) +
  geom_line(data = TotalTourists, color="orange", linetype = "solid") +
   ggtitle("Total Tourists") +
    xlab("Date (Monthly)") + ylab("Total Number of Tourists") +
    theme_linedraw()

```

# 4.3) Boxplot of the Data
```{r}

```


## 5) Google Trends Search Results for the keyword "Araba kiralama" over 2014-2022

In this section, Google Trends search results for the keyword "Araba kiralama" is analyzed.
Search results for "Araba kiralama" keyword are reported monthly.
Time range for the data is from March 2014 to January 2022.


# 5.1) Dataset
```{r}

GoogleTrends <- read.csv("Data/GoogleTrends.csv")
GoogleTrends$Month <- as.yearmon(GoogleTrends$Month)
head(GoogleTrends)
tail(GoogleTrends)
summary(GoogleTrends$Keyword)
str(GoogleTrends$Keyword)

```

# 5.2) Plot of the Data
```{r}

ggplot(GoogleTrends, aes(Month, Keyword)) +
  geom_line(data = GoogleTrends, color="purple", linetype = "solid") +
   ggtitle("Google Trend Results for Keyword: Araba kiralama") +
    xlab("Date") + ylab("Number of Searches") +
    theme_linedraw()

```

# 5.3) Boxplot of the Data
```{r}

```


## 6) Conclusion

In the conclusion, four data sets are compared in a correlation matrix.


# 6.1) Correlation Matrix

```{r}

data <- data.frame(ExpendCarRental$Amount,  InterestRateVehicles$Rates, TotalTourists$Tourists, GoogleTrends$Keyword)
data_cor = cor(data)
corrplot(data_cor, method="number")
```





